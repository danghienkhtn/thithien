<script src="<?php echo $this->static->backend->js;?>/jquery.fcbkcomplete2.js"></script>
<link rel="stylesheet" type="text/css" href="<?php echo $this->static->backend->css . '/autocomplete.css' ?>" />

<div class="asideCont borPaddNon clearfix" id="newproduct">
    <table width="100%" cellspacing="0" cellpadding="0" border="1" class="tblComm">
        <tbody>
            <tr>
                <th align="left" colspan="2">UPDATE GROUP</th>
            </tr>
          
            <tr>
                <td valign="top">
                    <div class="padLefRig20">
                        
                        <ul class="ulListIfSch">
                            
                              <li>
                                <p class="titleDes"><label>Group Name</label></p>
                                <input type="text" id="gName" name="gName" value="<?php echo $this->arrGroup['group_name'];?>" placeholder="Enter GroupName">
                                <p class="error" id="gNameError" ></p>
                            </li>
                            
                             <li>
                                <p class="titleDes"><label>Group Type</label></p>
                                <select id="group_type" name="group_type" class="seleComm width270">
                                    <?php 
                                   if(!empty($this->GroupType))
                                   {
                                       
                                        foreach ($this->GroupType as $key =>$value)
                                        {
                                            $select ='';
                                            if($key == $this->arrGroup['group_type']){
                                                $select='selected="selected"';
                                            }
                                         ?>
                                        <option value="<?php echo $key; ?>" <?php echo $select;?>><?php echo $value; ?></option>
                                        <?php 
                                        }
                                   }
                                   ?>
                                </select>
                                
                                <p class="error" id="gNameError" ></p>
                            </li>
                            
                              
                            
                            <li>
                                <p class="titleDes"><label>Country</label></p>
                                <select id="country_id" name="country_id" class="seleComm width270">
                                    <?php 
                                   if(!empty($this->arrCountry))
                                   {
                                        foreach ($this->arrCountry as $key =>$value)
                                        {
                                            $select ='';
                                            if($key == $this->arrGroup['country_id']){
                                                $select='selected="selected"';
                                            } 
                                         ?>
                                        <option value="<?php echo $key; ?>" <?php echo $select;?>><?php echo $value; ?></option>
                                        <?php 
                                        }
                                   }
                                   ?>
                                </select>
                                
                                <p class="error" id="gNameError" ></p>
                            </li>
                             <li>
                                <p class="titleDes"><label>Is Public</label></p>
                                <select id="is_public" name="is_public" class="seleComm width270">
                                    <?php 
                                   if(!empty($this->arrPublicStatus))
                                   {
                                        foreach ($this->arrPublicStatus as $key =>$value)
                                        {
                                            $select ='';
                                            if($key == $this->arrGroup['is_public']){
                                                $select='selected="selected"';
                                            } 
                                         ?>
                                        <option value="<?php echo $key; ?>" <?php echo $select;?>><?php echo $value; ?></option>
                                        <?php 
                                        }
                                   }
                                   ?>
                                </select>
                                
                                <p class="error" id="gNameError" ></p>
                            </li>
                            
                             <li>
                                <p class="titleDes"><label>Admin of Group</label></p>
                                 <select id="admin_id" name="admin_id"  ></select>
                                <p class="error" id="gDirectManagerError" ></p>
                            </li>
                            
                            <?php
                            $sImageUrl = (!empty($this->arrGroup['image_url'])) ? PATH_NEWS_URL .'/'. $this->arrGroup['image_url'] : '';
                           ?>
                            
                            <li>                        
                                <p class="titleDes"><label>Image</label></p>
                                <form name="uploadImage" url="<?php echo BASE_URL . "/upload/upload/type/1"; ?>">
                                    <div class="fileupload fileupload-new" data-provides="fileupload">
                                        <div class="fileupload-new thumbnail" style="width: 150px;"><img class="img" src="<?php echo !empty($sImageUrl)?$sImageUrl:'http://www.placehold.it/200x150/EFEFEF/AAAAAA&text=no+image';?>" width="150px" /></div>
                                        <div class="fileupload-preview fileupload-exists thumbnail" style="max-width: 200px; max-height: 150px; line-height: 20px;"></div>
                                        <div>
                                            <span class="btn btn-file"><span class="fileupload-new" id="btnUpload">Select image</span><span class="fileupload-exists">Change</span><input type="file" name="file_upload" accept="image/png, image/gif, image/jpeg" /></span>
                                            <a href="#" class="btn fileupload-exists" data-dismiss="fileupload">Remove</a>
                                        </div>
                                    </div>
                                    <div id="photoUploadResult" class="hidden"></div>
                                </form>
                                <p class="error" id="pImageError" ></p>
                                <input type="hidden" name="gPicture" value ="<?php echo $this->arrGroup['image_url'];?>" id ="gPicture" />
                            </li>
                            
                            <li>
                                <p class="titleDes"><label>Sort order</label></p>
                                <input type="text" id="gSortOrder" name="gSortOrder" value="<?php echo $this->arrGroup['sort_order'];?>" placeholder="Enter SortOrder">
                                <p class="error" id="gSortOrderError" ></p>
                            </li>
                            
                            <?php
                             $check1='checked';
                             $check2='';
                             
                             if($this->arrGroup['active'] ==0)
                             {
                                  $check1='';
                                  $check2='checked';
                             }
                             
                             ?>
                            <li>                        
                                <p class="titleDes"><label>Active</label></p>
                                <div class="product-display">
                                    <label class="radio">
                                        <input type="radio" name="gDisplay" value="1" <?php echo $check1;?>>Yes
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="gDisplay" value="0" <?php echo $check2;?>>No
                                    </label>
                                </div>
                                <p class="error" id="eventDisplayError" ></p>
                            </li>
                            
                            
                            
                            
                        </ul>
                    </div>
                </td>
                
            </tr>                  

            <tr>
                <td valign="top" colspan="2">
                    <div class="floatleft mLeft10 mTop10">
                        <a href="javascript:void(0)"  id="btnAdd1" class="button green">Update</a>
                        <input  type="hidden" name="group_id" id="group_id" value="<?php echo $this->arrGroup['group_id'];?>" />
                    </div>                    
                </td>                    
            </tr>
        </tbody>
    </table>
</div>
<div style="height: 30px"></div>

<div id="toTop">^ Back to Top</div> 
<script type="text/javascript">
     
   $(document).ready(function(){  
       
        document.domain = "<?php echo DOMAIN; ?>";
        $('.fileupload').fileupload({"name":"itemImage"});
    
    
        $("#admin_id").fcbkcomplete({
                    json_url: '<?php echo BASE_URL;?>/index/autocomplete',
                    addontab: true,                   
                    maxitems: 1,
                    input_min_size: 0,
                    height: 10,
                    width: '320px',
                    cache: false,
                    newel: false,
                    select_all_text: "",
                    input_value: '<?php echo isset($this->arrAccountInfo[0]['name'])?$this->arrAccountInfo[0]['name']:'';?>',
                    input_value_id: '<?php echo isset($this->arrAccountInfo[0]['account_id'])?$this->arrAccountInfo[0]['account_id']:0;?>'

        });
            
    $('#btnAdd1').click(function() {
        var name  = $('#gName').val(); 
        var sortorder  = $('#gSortOrder').val(); 
        var id  = $('#group_id').val();
        var group_type  = $('#group_type').val();
        var country_id  = $('#country_id').val();
        var admin_id  = $('#admin_id').val();
        var is_public  = $('#is_public').val();
        var image = $('#photoUploadResult .response .image_id').html();
        var picture = $('#gPicture').val();
       
        var active = $("input:radio[name='gDisplay']:checked").val();
        
        if (image == undefined) {
            image = picture;
        } else {
            image = $('#photoUploadResult .response .image_id').html() + "." + $('#photoUploadResult .response .image_format').html();
        }
        

       
        if (name =='') {
            alert('Please input GroupName!');
            return;
        }
        
 
        var params = {
            active:active,
            name:name,
            group_type:group_type,
            sortorder:sortorder,
            country_id:country_id,
            admin_id:admin_id,
            is_public:is_public,
            image:image,
            id:id
        };

        $.post("<?php echo BASE_ADMIN_URL; ?>/group/add", params, function(result){
            if(result.error == 0)
            {
                window.location= '<?php echo BASE_ADMIN_URL; ?>/group/index/page/<?php echo $this->iPage;?>';
            }
            else
            {
                alert(result.message);
            }
        },'json');
    });
  
 });  
</script>